<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VIBE - AI Programming Assistant Experiment</title>

    <!-- FIX: Use the correct CSS file -->
    <link rel="stylesheet" href="./css/main.css" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap"
      rel="stylesheet"
    />

    <!-- CodeMirror -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/codemirror.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.1/theme/dracula.min.css"
    />

    <!-- GitHub Pages specific configuration -->
    <script>
      // Set backend URL for GitHub Pages
      window.BACKEND_URL = "BACKEND_URL_PLACEHOLDER";

      // Debug info
      console.log("🌐 Running on GitHub Pages");
      console.log("📡 Backend URL:", window.BACKEND_URL);
    </script>
  </head>
  <body class="text-sm">
    <!-- GitHub Pages Notice -->
    <div
      id="github-pages-notice"
      class="bg-blue-600 text-white text-center py-2 text-xs"
    >
      🚀 Running on GitHub Pages - Backend powered by Azure |
      <span id="backend-status">Testing connection...</span>
    </div>

    <!-- Rest of your existing HTML content from index.html -->
    <!-- This content will be inserted by the GitHub Actions workflow -->

    <!-- GitHub Pages specific scripts - load after main content -->
    <script type="module">
      // Test backend connection and show status
      if (
        window.BACKEND_URL &&
        window.BACKEND_URL !== "BACKEND_URL_PLACEHOLDER"
      ) {
        console.log("Testing backend connection to:", window.BACKEND_URL);

        // Test the health endpoint
        fetch(`${window.BACKEND_URL}/api/health`)
          .then((response) => {
            if (!response.ok) {
              throw new Error(
                `HTTP ${response.status}: ${response.statusText}`
              );
            }
            return response.json();
          })
          .then((data) => {
            console.log("✅ Backend health check successful:", data);
            document.getElementById("backend-status").textContent =
              "✅ Backend Connected";
          })
          .catch((error) => {
            console.error("❌ Backend health check failed:", error);
            document.getElementById("backend-status").textContent =
              "❌ Backend Offline";

            // Show more detailed error info
            const notice = document.getElementById("github-pages-notice");
            notice.innerHTML = `
              🚀 Running on GitHub Pages - Backend powered by Azure |
              <span style="color: #ff6b6b;">❌ Backend connection failed: ${error.message}</span>
            `;
          });
      } else {
        console.error("❌ Backend URL not configured");
        document.getElementById("backend-status").textContent =
          "❌ Config Missing";
      }
    </script>
  </body>
</html>
